#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
This file creates creates a data frame of the average runtimes using Minimap2 
as csv file.

NOTE: The times are hard coded into the file. We were unable to figure out how to
extract the runtime from the minimap output. These times are what was stated on
the comand line output after each run.
"""

import numpy as np
import pandas as pd


# run 1
n100_time_arr1 = np.array([0.015, 0.014, 0.008, 0.012,
                          0.007, 0.006, 0.015, 0.012, 
                          0.004, 0.004, 0.005, 0.004,
                          0.004, 0.006, 0.009, 0.006])

n150_time_arr1 = np.array([0.007, 0.009, 0.012, 0.012,
                          0.006, 0.008, 0.006, 0.006,
                          0.005, 0.006, 0.005,0.006,
                          0.005,0.006, 0.006, 0.008])

n200_time_arr1 = np.array([0.011, 0.014, 0.019, 0.020,
                          0.006, 0.005, 0.008, 0.006,
                          0.008, 0.005, 0.005, 0.006,
                          0.005, 0.006, 0.005, 0.006])

n250_time_arr1 = np.array([0.014, 0.016, 0.020, 0.021,
                          0.007, 0.007, 0.006, 0.006,
                          0.006, 0.005, 0.006, 0.015,
                          0.005, 0.006, 0.006, 0.005])

# run 2
n100_time_arr2 = np.array([0.014, 0.011, 0.012, 0.007,
                           0.009, 0.008, 0.007, 0.004,
                           0.005, 0.005, 0.004, 0.005,
                           0.005, 0.004, 0.004, 0.004])

n150_time_arr2 = np.array([0.009, 0.011, 0.012, 0.013,
                           0.006, 0.019, 0.005, 0.005,
                           0.007, 0.006, 0.005, 0.006,
                           0.005, 0.009, 0.13, 0.006])

n200_time_arr2 = np.array([0.011, 0.011, 0.016, 0.015,
                           0.005, 0.006, 0.006, 0.006,
                           0.008, 0.007, 0.006, 0.005,
                           0.006, 0.006, 0.005, 0.007])

n250_time_arr2 = np.array([0.012, 0.015, 0.030, 0.022,
                           0.007, 0.012, 0.007, 0.006,
                           0.006, 0.006, 0.005, 0.005,
                           0.007, 0.007, 0.006, 0.007])

# run 3
n100_time_arr3 = np.array([0.013, 0.016, 0.010, 0.018,
                           0.020, 0.016, 0.006, 0.005,
                           0.005, 0.005, 0.005, 0.011,
                           0.005, 0.005, 0.006, 0.005])

n150_time_arr3 = np.array([0.014, 0.010, 0.013, 0.012,
                           0.006, 0.007, 0.006, 0.005,
                           0.006, 0.006, 0.008, 0.005,
                           0.008, 0.011, 0.011, 0.012])

n200_time_arr3 = np.array([0.010, 0.014, 0.015, 0.017,
                           0.005, 0.007, 0.006, 0.008,
                           0.006, 0.005, 0.008, 0.005,
                           0.008, 0.011, 0.009, 0.006])

n250_time_arr3 = np.array([0.014, 0.017, 0.020, 0.028,
                           0.008, 0.008, 0.007, 0.007,
                           0.006, 0.005, 0.006, 0.005,
                           0.005, 0.007, 0.006, 0.007])

# run 4
n100_time_arr4 = np.array([0.009, 0.017, 0.017, 0.012,
                           0.004, 0.012, 0.010, 0.015,
                           0.011, 0.008, 0.008, 0.007,
                           0.005, 0.011, 0.006, 0.005])

n150_time_arr4 = np.array([0.009, 0.010, 0.011, 0.016,
                           0.007, 0.006, 0.005, 0.005,
                           0.006, 0.006, 0.005, 0.006,
                           0.005, 0.007, 0.007, 0.006])

n200_time_arr4 = np.array([0.012, 0.013, 0.017, 0.015,
                           0.006, 0.006, 0.006, 0.007,
                           0.008, 0.006, 0.005, 0.005,
                           0.005, 0.006, 0.006, 0.006])

n250_time_arr4 = np.array([0.012, 0.037, 0.017, 0.019,
                           0.008, 0.007, 0.007, 0.008,
                           0.005, 0.006, 0.006, 0.005,
                           0.006, 0.006, 0.006, 0.005])

# run 5
n100_time_arr5 = np.array([0.015, 0.011, 0.010, 0.008,
                           0.005, 0.011, 0.005, 0.006,
                           0.005, 0.008, 0.012, 0.005,
                           0.007, 0.004, 0.004, 0.005])

n150_time_arr5 = np.array([0.011, 0.011, 0.015, 0.011,
                           0.007, 0.007, 0.005, 0.006,
                           0.005, 0.005, 0.005, 0.008,
                           0.005, 0.006, 0.007, 0.005])

n200_time_arr5 = np.array([0.011, 0.011, 0.016, 0.017,
                           0.006, 0.008, 0.005, 0.006,
                           0.005, 0.005, 0.006, 0.006,
                           0.007, 0.006, 0.005, 0.005])

n250_time_arr5 = np.array([0.012, 0.016, 0.020, 0.019,
                           0.006, 0.008, 0.006, 0.006,
                           0.006, 0.007, 0.005, 0.007,
                           0.007, 0.007, 0.006, 0.006])

# run 6
n100_time_arr6 = np.array([0.016, 0.007, 0.010, 0.008,
                           0.007, 0.011, 0.006, 0.006,
                           0.008, 0.005, 0.004, 0.005,
                           0.004, 0.005, 0.005, 0.005])

n150_time_arr6 = np.array([0.009, 0.011, 0.012, 0.013,
                           0.006, 0.007, 0.005, 0.008,
                           0.006, 0.006, 0.005, 0.005,
                           0.005, 0.006, 0.008, 0.005])

n200_time_arr6 = np.array([0.014, 0.014, 0.016, 0.016,
                           0.006, 0.007, 0.005, 0.005,
                           0.007, 0.006, 0.005, 0.005,
                           0.006, 0.006, 0.005, 0.007])

n250_time_arr6 = np.array([0.013, 0.015, 0.020, 0.020,
                           0.008, 0.008, 0.007, 0.007,
                           0.007, 0.008, 0.010, 0.018,
                           0.013, 0.008, 0.012, 0.006])

# run 7
n100_time_arr7 = np.array([0.015, 0.019, 0.014, 0.013,
                           0.006, 0.005, 0.005, 0.004,
                           0.006, 0.004, 0.005, 0.005,
                           0.005, 0.004, 0.004, 0.006])

n150_time_arr7 = np.array([0.009, 0.009, 0.011, 0.013,
                           0.005, 0.007, 0.006, 0.005,
                           0.004, 0.005, 0.005, 0.006,
                           0.005, 0.006, 0.005, 0.005])

n200_time_arr7 = np.array([0.009, 0.014, 0.015, 0.025,
                           0.006, 0.006, 0.005, 0.006,
                           0.005, 0.005, 0.007, 0.006,
                           0.005, 0.005, 0.005, 0.005])

n250_time_arr7 = np.array([0.011, 0.016, 0.018, 0.018,
                           0.007, 0.005, 0.006, 0.007,
                           0.006, 0.006, 0.006, 0.005,
                           0.006, 0.005, 0.006, 0.006])

# run 8
n100_time_arr8 = np.array([0.012, 0.028, 0.028, 0.011,
                           0.008, 0.005, 0.005, 0.005,
                           0.008, 0.010, 0.004, 0.004,
                           0.012, 0.008, 0.004, 0.006])

n150_time_arr8 = np.array([0.008, 0.009, 0.010, 0.011,
                           0.006, 0.006, 0.005, 0.005,
                           0.007, 0.005, 0.007, 0.005,
                           0.005, 0.006, 0.006, 0.005])

n200_time_arr8 = np.array([0.011, 0.014, 0.015, 0.014,
                           0.007, 0.006, 0.013, 0.006,
                           0.005, 0.004, 0.005, 0.005,
                           0.006, 0.004, 0.006, 0.004])

n250_time_arr8 = np.array([0.013, 0.023, 0.020, 0.021,
                           0.007, 0.008, 0.006, 0.008,
                           0.008, 0.006, 0.007, 0.007,
                           0.005, 0.006, 0.007, 0.006])

# run 9
n100_time_arr9 = np.array([0.016, 0.011, 0.008, 0.008,
                           0.008, 0.015, 0.005, 0.006,
                           0.007, 0.005, 0.007, 0.007,
                           0.006, 0.005, 0.031, 0.007])

n150_time_arr9 = np.array([0.010, 0.013, 0.012, 0.012,
                           0.009, 0.008, 0.005, 0.006,
                           0.007, 0.008, 0.005, 0.005,
                           0.006, 0.039, 0.007, 0.006])

n200_time_arr9 = np.array([0.025, 0.013, 0.016, 0.014,
                           0.006, 0.007, 0.005, 0.006,
                           0.005, 0.007, 0.005, 0.005,
                           0.005, 0.005, 0.005, 0.005])

n250_time_arr9 = np.array([0.012, 0.017, 0.019, 0.021,
                           0.007, 0.008, 0.006, 0.006,
                           0.006, 0.006, 0.005, 0.007,
                           0.007, 0.006, 0.008, 0.007])

# run 10
n100_time_arr10 = np.array([0.011, 0.011, 0.011, 0.013,
                            0.006, 0.006, 0.014, 0.018,
                            0.005, 0.005, 0.012, 0.010,
                            0.005, 0.004, 0.004, 0.005])

n150_time_arr10 = np.array([0.009, 0.019, 0.015, 0.021,
                            0.006, 0.012, 0.013, 0.026,
                            0.017, 0.016, 0.012, 0.005,
                            0.007, 0.011, 0.013, 0.010])

n200_time_arr10 = np.array([0.014, 0.015, 0.018, 0.019,
                            0.008, 0.008, 0.007, 0.009,
                            0.006, 0.008, 0.017, 0.011,
                            0.005, 0.006, 0.006, 0.005])

n250_time_arr10 = np.array([0.014, 0.016, 0.038, 0.037,
                            0.025, 0.026, 0.013, 0.009,
                            0.006, 0.011, 0.005, 0.007,
                            0.006, 0.006, 0.006, 0.017])

# average time
n100_avg_time_arr = np.average([n100_time_arr1,n100_time_arr2,
                                n100_time_arr3,n100_time_arr4,
                                n100_time_arr5,n100_time_arr6,
                                n100_time_arr7,n100_time_arr8,
                                n100_time_arr9,n100_time_arr10],axis=0)

n150_avg_time_arr = np.average([n150_time_arr1,n150_time_arr2,
                                n150_time_arr3,n150_time_arr4,
                                n150_time_arr5,n150_time_arr6,
                                n150_time_arr7,n150_time_arr8,
                                n150_time_arr9,n150_time_arr10],axis=0)

n200_avg_time_arr = np.average([n200_time_arr1,n200_time_arr2,
                                n200_time_arr3,n200_time_arr4,
                                n200_time_arr5,n200_time_arr6,
                                n200_time_arr7,n200_time_arr8,
                                n200_time_arr9,n200_time_arr10],axis=0)

n250_avg_time_arr = np.average([n250_time_arr1,n250_time_arr2,
                                n250_time_arr3,n250_time_arr4,
                                n250_time_arr5,n250_time_arr6,
                                n250_time_arr7,n250_time_arr8,
                                n250_time_arr9,n250_time_arr10],axis=0)

# Lengths of reads:
n_vals = [100, 150, 200, 250]
# Error rate
e_vals = [0.05, 0.25, 0.5, 0.75]
# Substitution vs. Deletion ratio
s_vals = [0.95, 0.75, 0.25, 0.05]

data_df = pd.DataFrame(index=n_vals)

i = 0
for e in e_vals:
    for s in s_vals:
        time_arr = np.array([n100_avg_time_arr[i],n150_avg_time_arr[i],n200_avg_time_arr[i],n250_avg_time_arr[i]])
        data_df["e="+str(e)+",s="+str(s)] = time_arr
        i += 1
        
data_df.to_csv('synth_minimap_time.csv')
                